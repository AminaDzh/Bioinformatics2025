Сначала делаем fastqc и multiqc исходных файлов скриптом qc.slurm

Потом тримминг скриптом fastp.slurm

Делаем fastqc и multiqc обработанных файлов скриптом qc_fastp.slurm

Сравниваем отчеты, в моем случае почти ничего не поменлось, только после обработки немного ухудшилось распределение длин

Для простоты будем использовать исходные последовательности

Выровниваем риды на референсный геном /projects/mipt_dbmp_biotechnology/GRCh38/ с помощью STAR с параметром для получения каунтов, используется скрипт star.slurm

Далее для получения gtf файла используем strigtie.sh. На выходе имеем transcripts.gtf





Я изучила по источникам что входит в gtf файл, вот:



Каждая строка описывает один геномный элемент (транскрипт, экзон и т. д.) и состоит из 9 колонок:

seqname (1) — Хромосома или контиг (здесь 1).

source (StringTie) — Программа, создавшая запись.

feature (transcript/exon) — Тип элемента:

transcript — целый транскрипт,

exon — отдельный экзон.

start (945094) — Начальная позиция элемента.

end (948565) — Конечная позиция элемента.

score (1000) — Субъективная оценка качества (часто . или 1000).

strand (-/+) — Цепь ДНК: + (прямая) или - (обратная).

frame (.) — Фазность кодона (0, 1, 2 или ., если не применимо).

attributes — Дополнительные атрибуты в формате ключ "значение";.


Атрибуты содержат ключевую информацию. Вот расшифровка:

Для транскрипта:
gtf
gene_id "HM_RNA_SEQ.1";               # Уникальный ID гена
transcript_id "HM_RNA_SEQ.1.1";       # Уникальный ID транскрипта
cov "1.617600";                       # Покрытие ридами (средняя глубина)
FPKM "3.104465";                      # Уровень экспрессии в FPKM
TPM "49.656040";                      # Уровень экспрессии в TPM
reference_id "ENST00000469563";       # ID транскрипта из референса (если есть)
ref_gene_id "ENSG00000188976";        # ID гена из референса
ref_gene_name "NOC2L";                # Символьное имя гена из референса



Для экзона:
gtf
gene_id "HM_RNA_SEQ.1";               # ID гена (как у транскрипта)
transcript_id "HM_RNA_SEQ.1.1";       # ID транскрипта (как у родителя)
exon_number "1";                      # Порядковый номер экзона в транскрипте
cov "1.000000";                       # Покрытие ридами для этого экзона


Ключевые метрики экспрессии
StringTie рассчитывает два основных показателя:

FPKM (Fragments Per Kilobase per Million) — нормализованная экспрессия на длину транскрипта и общее число ридов.

TPM (Transcripts Per Million) — более стабильная метрика, учитывающая распределение экспрессии между генами.


